# API IngeCiencia - DivulgaciÃ³n CientÃ­fica FIM UAS

**Autor:** Apodaca Concha Orlando Armando

## ğŸ“‹ DescripciÃ³n

API REST para la plataforma web de divulgaciÃ³n cientÃ­fica de la Facultad de IngenierÃ­a MetalÃºrgica (FIM) de la Universidad AutÃ³noma de Sinaloa. Proporciona endpoints para gestionar artÃ­culos, preguntas, recursos, usuarios y autenticaciÃ³n.

## ğŸ› ï¸ TecnologÃ­as

- **Runtime:** Node.js
- **Framework:** Express.js
- **Base de Datos:** MySQL
- **AutenticaciÃ³n:** JWT (JSON Web Tokens)
- **ContainerizaciÃ³n:** Docker

## âœ… Requisitos Previos

- Node.js (v14 o superior)
- npm o yarn
- MySQL (v5.7 o superior)
- Docker (opcional)

## ğŸ“¦ InstalaciÃ³n

### 1. Clonar el repositorio

```bash
git clone <repository-url>
cd API-IngeCiencia
```

### 2. Instalar dependencias

```bash
npm install
```

### 3. Configurar variables de entorno

```bash
# Copiar el archivo template
cp .env.template .env

# Completar las variables en el archivo .env
```

## âš™ï¸ ConfiguraciÃ³n

Las variables de entorno se definen en el archivo `.env`. Consulta [.env.template](.env.template) para ver todos los parÃ¡metros disponibles.

### Variables Principales

- `PORT` - Puerto del servidor (por defecto: 3000)
- `DB_HOST` - Host de la base de datos
- `DB_USER` - Usuario de MySQL
- `DB_PASS` - ContraseÃ±a de MySQL
- `DB_DATABASE` - Nombre de la base de datos
- `DB_PORT` - Puerto de MySQL (por defecto: 3306)
- `JWT_SECRET` - Clave secreta para tokens JWT
- `JWT_REFRESH_SECRET` - Clave secreta para refresh tokens

## ï¿½ï¸ Base de Datos

### SincronizaciÃ³n AutomÃ¡tica

La base de datos se sincroniza automÃ¡ticamente al iniciar el servidor. Sequelize crearÃ¡ todas las tablas segÃºn los modelos definidos en `src/database/models/`.

**El archivo `DB.sql` ya no es necesario para el setup**.

### Datos Iniciales (Seed Manual)

Para ejecutar el seed que completa la base de datos con datos de ejemplo, usa:

```bash
pnpm seed
```

El seed crea:

- âœ“ **Roles:** `lector`, `autor`, `editor`, `admin`
- âœ“ **CategorÃ­as:** IngenierÃ­a MetalÃºrgica, Ciencia de Materiales, etc.
- âœ“ **Usuarios:** Admin y autor de ejemplo con sus perfiles
- âœ“ **ArtÃ­culos:** Ejemplos de artÃ­culos cientÃ­ficos
- âœ“ **Preguntas:** Preguntas iniciales
- âœ“ **Recursos:** GuÃ­as, talleres y convocatorias de ejemplo

**Salida en consola:**

```
ğŸŒ± Iniciando seed de la base de datos...

â†³ Verificando datos iniciales...
â†³ Creando datos de prueba...
  âœ“ 4 roles creados
  âœ“ 7 categorÃ­as creadas
  âœ“ 2 usuarios creados con perfiles
  âœ“ 2 artÃ­culos creados
  âœ“ 2 preguntas creadas
  âœ“ 2 recursos creados
âœ“ Seed completado correctamente
```

**Usuarios de Prueba:**

- **Admin:** `admin` / `admin123`
- **Autor:** `autor1` / `author123`

### Personalizar los Datos Iniciales

Edita el archivo [src/database/seed.js](src/database/seed.js) para modificar o agregar mÃ¡s datos iniciales.

## ï¿½ğŸš€ Uso

### Iniciar el servidor en desarrollo

```bash
pnpm dev
```

### Ejecutar el Seed (Datos Iniciales)

```bash
pnpm seed
```

### Build para producciÃ³n

```bash
pnpm build
```

### Iniciar servidor en producciÃ³n

```bash
pnpm start
```

### Con Docker

```bash
docker build -t api-ingeciencia .
docker run -p 3000:3000 --env-file .env api-ingeciencia
```

## ğŸ“ Estructura del Proyecto

```
src/
â”œâ”€â”€ controllers/          # LÃ³gica de negocio
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ connection.js    # ConfiguraciÃ³n de conexiÃ³n
â”‚   â””â”€â”€ models/          # Modelos de datos
â”œâ”€â”€ middlewares/         # Middlewares personalizados
â”œâ”€â”€ routes/              # DefiniciÃ³n de rutas
â”œâ”€â”€ utils/               # Funciones utilitarias
â”œâ”€â”€ app.js              # ConfiguraciÃ³n de Express
â”œâ”€â”€ jwtconfig.js        # ConfiguraciÃ³n JWT
â””â”€â”€ index.js            # Punto de entrada
```

## ğŸ”Œ Endpoints Principales

### AutenticaciÃ³n

- `POST /api/auth/login` - Login de usuario
- `POST /api/auth/register` - Registro de usuario
- `POST /api/auth/refresh` - Renovar token JWT

### ArtÃ­culos

- `GET /api/articles` - Obtener artÃ­culos
- `POST /api/articles` - Crear artÃ­culo
- `GET /api/articles/:id` - Obtener artÃ­culo por ID
- `PUT /api/articles/:id` - Actualizar artÃ­culo
- `DELETE /api/articles/:id` - Eliminar artÃ­culo

### CategorÃ­as

- `GET /api/categories` - Obtener categorÃ­as
- `POST /api/categories` - Crear categorÃ­a
- `PUT /api/categories/:id` - Actualizar categorÃ­a
- `DELETE /api/categories/:id` - Eliminar categorÃ­a

### Usuarios

- `GET /api/users` - Obtener usuarios
- `GET /api/users/:id` - Obtener usuario por ID
- `PUT /api/users/:id` - Actualizar usuario
- `DELETE /api/users/:id` - Eliminar usuario

### Preguntas

- `GET /api/questions` - Obtener preguntas
- `POST /api/questions` - Crear pregunta
- `GET /api/questions/:id` - Obtener pregunta por ID

### Recursos

- `GET /api/resources` - Obtener recursos
- `POST /api/resources` - Crear recurso
- `GET /api/resources/:id` - Obtener recurso por ID

### Proyectos de InvestigaciÃ³n

- `GET /api/research-projects` - Obtener proyectos
- `POST /api/research-projects` - Crear proyecto

## AutenticaciÃ³n

La API utiliza JWT para la autenticaciÃ³n. Los tokens deben enviarse en el header `Authorization`:

```
Authorization: Bearer <token>
```

## ğŸ“ Archivos de Solicitud HTTP

En la carpeta `requests/` se encuentran archivos `.http` para probar los endpoints con clientes HTTP como REST Client de VS Code:

- `articles.http` - Endpoints de artÃ­culos
- `users.http` - Endpoints de usuarios
- `categories.http` - Endpoints de categorÃ­as
- `questions.http` - Endpoints de preguntas
- `recursos.http` - Endpoints de recursos
- `custom.http` - Solicitudes personalizadas

## ğŸ“§ Contacto

Para consultas o reportar problemas, contactar al autor del proyecto.
